const replaceHtmlEntites=function(){var a={nbsp:String.fromCharCode(160),amp:"&",quot:"\"",lt:"<",gt:">"},b=function(b,c){return a[c]};return function(a){return a.replace(/&(nbsp|amp|quot|lt|gt);/g,b)}}();Object.prototype.do=function(a){return a.call(this),this};class UV{constructor(){this.uvRenderer,this.components=[]}createRenderer(){return this.uvRenderer=new UVRenderer}async add(...a){this.components.push(...a)}async define(...a){a.forEach(async a=>{const b=(this.uvRenderer||this.createRenderer()).render(a),c=UVComponent.from(b);this.add(c)})}async defineFromMUVFile(a,b){const c=await fetch(b).then(a=>a.text());this.defineFromMUV(a,c)}async defineFromMUV(a,b){const c=(this.uvRenderer||this.createRenderer()).renderText(a,window.atob(b)),d=UVComponent.from(c);this.components.push(d)}render(){document.head.appendChild(document.createElement("style").do(function(){this.innerHTML+="@import url(\"https://raw.githubusercontent.com/UV-mod/source/main/uvcondo/uvcondo.css\")"})),this.components.forEach(async _comp=>{const component=await _comp,html=component.shadow,componentName="uv-"+component.id;window.customElements.define(componentName,class extends HTMLElement{constructor(){super(),this.shadow=void 0,0!=html.children.length&&(this.shadow=this.attachShadow({mode:"open"})),this.css=document.createElement("style"),this.css.innerHTML+=replaceHtmlEntites(component.style.innerHTML),(this.shadow||window.document.head).appendChild(this.css),null!=this.shadow&&(this.shadow.innerHTML+=html.innerHTML.replace(/\$text/gm,this.innerHTML).trim(),this.innerHTML=""),this.startScript=eval(`(function(multiMethod, parentElement, shadow){${replaceHtmlEntites(component.script.innerHTML)}})`)}connectedCallback(){this.fnres=this.startScript.call(this.shadow||this,{adaptiveColor:function(a,b="#000000",c="#ffffff"){var d=a.substring(a.indexOf("(")+1,a.lastIndexOf(")")).split(/,\s*/),e=d[0],f=d[1],g=d[2],h=Math.sqrt(e*e+f*f+g*g);return 128<h?b:c}},this.parentElement,this.shadow),[...this.attributes].forEach(a=>{this.attributeChangedCallback(a.name,a.value,a.value)})}disconnectedCallback(){}static get observedAttributes(){return this.fnres?.observe?.attributes||[]}attributeChangedCallback(a,b,c){this?.fnres?.observe?.callback(a,b,c)}adoptedCallback(){}})})}}class UVRenderer{constructor(){this.domParser=new DOMParser}async render(a){const b=await fetch(a).then(a=>a.text());return this.domParser.parseFromString(`<component id="${a.split(/[\/\\]/g).at(-1).split(".").at(0)}">${b}</component>`.replace(/&/gm,"&amp;"),"application/xml")}async renderText(a,b){return this.domParser.parseFromString(`<component id="${await a}">${await b}</component>`.replace(/&/gm,"&amp;"),"application/xml")}}class UVComponent{constructor(){this.id=void 0,this.shadow=void 0,this.style=void 0,this.script=void 0,this.element=void 0}static async from(a){var b=new UVComponent;const c=(await a).documentElement;return b.element=c,b.id=c.getAttribute("id"),b.shadow=c.getElementsByTagName("shadow")[0],b.style=c.getElementsByTagName("style")[0],b.script=c.getElementsByTagName("script")[0],b}static renderCSS(a){const b=[...a.matchAll(/\s*(.*)\s*\{\s*([^{}]*)\s*\}/gm)];if(b.some(a=>3!=a.length))throw new Error("Length error");return b.map(a=>({selector:a.at(1).trim(),value:a.at(2).trim().replace(/[\r\n\t]/gm,"").split(";").map(a=>a.split(":").map(a=>a.trim())).filter(a=>a.some(a=>""!=a))}))}}const uv=new UV;uv.classes={},uv.classes.UVComponent=UVComponent,uv.classes.UVRenderer=UVRenderer,uv.classes.UV=UV,(window||globalThis).uv=uv;